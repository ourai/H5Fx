/*!
 * Html5form v0.1.0
 * https://github.com/ourai/html5form
 *
 * Copyright 2015, 2015 Ourairyu, http://ourai.ws/
 *
 * Date: 2015-02-21
 */

!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("Requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;f={name:"H5F",version:"0.1.0"},g="{{s*([A-Z_]+)s*}}",h={ABSOLUTE_URL:/^.*$/,EMAIL:/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,NUMBER:/^\d+(\.0+)?$/},b={COULD_NOT_BE_EMPTY:"{{LABEL}} could not be empty.",UNKNOWN_INPUT_TYPE:"Unknown input type for {{LABEL}}.",LENGTH_SMALLER_THAN_MINIMUM:"The length of {{LABEL}} is smaller than {{MINLENGTH}}.",LENGTH_BIGGER_THAN_MAXIMUM:"The length of {{LABEL}} is bigger than {{MAXLENGTH}}.",INVALID_VALUE:"{{LABEL}}'s value is invalid.",NOT_AN_ABSOLUTE_URL:"{{LABEL}} isn't an absolute URL.",NOT_AN_EMAIL:"{{LABEL}} isn't an E-mail.",NOT_A_NUMBER:"{{LABEL}} isn't a number.",UNDERFLOW:"{{LABEL}}'s value is smaller than {{MIN}}.",OVERFLOW:"{{LABEL}}'s value is bigger than {{MAX}}.",DIFFERENT_VALUE:"{{LABEL}}'s value is different from {{ASSOCIATE_LABEL}}."},l=function(a){var b,c;switch(a.get(0).tagName.toLowerCase()){case"textarea":b="textarea";break;case"input":b=null!=(c=a.attr("type"))?c:"text"}return b},r=function(a){return-1!==$.inArray($(a).prop("type"),["radio","checkbox"])},q=function(a,b){return a.hasAttribute(b)},u=function(){return this.valid=!0,this.message=""},w=function(a){return parseFloat(a)},o=function(a,b){var c;return $.isNumeric(c=$(a).prop(b))?w(c):null},s=function(a,b){var c;return null!=(c=a.attr("id"))?$("label[for='"+c+"']",b):a.closest("label")},m=function(a,b){var c,d;return d=a.attr("data-h5f-label"),null==d&&(c=s(a,b),d=c.size()>0?$.trim(c.text()):""),d},i=function(a){return $("#"+$(a).attr("data-h5f-associate"))},d=function(){function a(a){var b,c,d;a=$(a),c=a.closest("form").eq(0),this.form=c.get(0),this.type=l(a),this.name=a.prop("name"),this.__validations=[],r(a)?(d=$("[name='"+this.name+"'][required]",c),this.element=$.makeArray($("[name='"+this.name+"']",c)),this.required=d.size()>0,b=this.required?d.eq(0):$(this.element[0])):(this.element=a.get(0),this.required=q(this.element,"required"),this.pattern=a.attr("pattern"),b=a,this.required&&s(b,c).addClass("H5F-label--required")),this.label=m(b,c),u.call(this)}return a.prototype.value=function(){return r(this.element)?$("[name='"+this.name+"']:checked",$(this.form)).val():$(this.element).val()},a.prototype.reset=u,a.prototype.error=function(a){var c,d;return d=this,c=$(d.element),b[a].replace(new RegExp(g,"g"),function(a,b){var e;switch(b){case"LABEL":e=d.label;break;case"VALUE":e=d.value();break;case"ASSOCIATE_LABEL":e=m(i(c),$(d.form));break;case"MINLENGTH":e=c.attr("minlength");break;case"MAXLENGTH":e=c.attr("maxlength");break;case"MIN":e=o(c,"min");break;case"MAX":e=o(c,"max")}return e})},a.prototype.validate=function(){var a,b,c,d,e,f,j,k;if(b=this.element,e=this.value(),this.required&&""===$.trim(e))this.valid=!1,this.message=this.error("COULD_NOT_BE_EMPTY");else{switch(this.type){case"text":case"search":case"tel":case"url":case"email":case"password":case"textarea":q(b,"minlength")&&e.length<1*$(b).attr("minlength")?(this.valid=!1,this.message=this.error("LENGTH_SMALLER_THAN_MINIMUM")):q(b,"maxlength")&&e.length>1*$(b).attr("maxlength")?(this.valid=!1,this.message=this.error("LENGTH_BIGGER_THAN_MAXIMUM")):(""!==e&&("url"===this.type?(this.valid=h.ABSOLUTE_URL.test(e),this.valid||(this.message=this.error("NOT_AN_ABSOLUTE_URL"))):"email"===this.type&&(this.valid=h.EMAIL.test(e),this.valid||(this.message=this.error("NOT_AN_EMAIL")))),this.valid&&null!=this.pattern&&""!==this.pattern&&(this.valid=(null!=(f=h[null!=(j=null!=(k=this.pattern.match(new RegExp("^s*"+g+"s*$")))?k[1]:void 0)?j:""])?f:new RegExp("^"+this.pattern+"$")).test(e),this.valid||(this.message=this.error("INVALID_VALUE"))));break;case"number":""!==e&&(this.valid=h.NUMBER.test(e),this.valid?(d=o(b,"min"),c=o(b,"max"),null!=d&&w(e)<d?(this.valid=!1,this.message=this.error("UNDERFLOW")):null!=c&&w(e)>c&&(this.valid=!1,this.message=this.error("OVERFLOW"))):this.message=this.error("NOT_A_NUMBER"));break;default:this.message=this.error("UNKNOWN_INPUT_TYPE")}this.valid&&!r(b)&&q(b,"data-h5f-associate")&&(a=i(b),a.size()&&(this.valid=e===a.val(),this.valid||(this.message=this.error("DIFFERENT_VALUE")))),this.valid&&this.__validations.length>0&&$.each(this.__validations,function(a){return function(c,d){var e;return a.valid=$.isFunction(d.handler)?d.handler.call(b)===!0:!1,a.valid||(a.message=/^[A-Z_]+$/.test(d.message)?a.error(d.message):null!=(e="function"==typeof d.message?d.message():void 0)?e:d.message),a.valid}}(this))}return $($.isArray(b)?b[0]:b).trigger("H5F:"+(this.valid?"valid":"invalid"),this),this.valid},a.prototype.addValidation=function(a){return this.__validations.push(a),a},a}(),c={BEFORE_VALIDATE:"H5F:beforeValidate",SUBMIT:"H5F:submit",DESTROY:"H5F:destroy",VALIDATE:"H5F:validate"},v=":submit, :image, :reset",k={immediate:!1},t=function(a){var b;return b=navigator.userAgent.toLowerCase().match(/msie (\d+\.\d+)/),null!=b?1*b[1]<a:!1},x=function(a,b){return b.reset(),b.validated=!0,b.validate()?(b.counted===!0&&(a.invalidCount=--a.invalidCount),b.counted=!1):(b.counted!==!0&&(a.invalidCount=++a.invalidCount),b.counted=!0),b},y=function(a,b){return $.each(a.sequence,function(d,e){var f,g;return g=a.fields[e],b||(g.validated=!1),f=g.element,g.validated===!1&&$($.isArray(f)?f[0]:f).trigger(c.VALIDATE),!0})},j=function(a,b,d){return $("[name]",a).on(c.VALIDATE,function(){return x(b,b.fields[$(this).prop("name")])}),d===!0&&($("[name]:checkbox, [name]:radio",a).on("change.H5F",function(){return $(this).trigger(c.VALIDATE)}),$("[name]:not(:checkbox, :radio, "+v+", select, option)",a).on(t(9)?"change.H5F":"input.H5F",function(){return $(this).trigger(c.VALIDATE)})),a.on("submit.H5F",function(a){return $(this).trigger(c.BEFORE_VALIDATE,b),y(b,d),b.invalidCount>0?(a.preventDefault(),a.stopImmediatePropagation()):$(this).trigger(c.SUBMIT,[b,a])})},n=function(){return"H5F"+(new Date).getTime().toString(16)+"F0RM"+(e.forms.length+1).toString(16)},p=function(a){var b,c;return"object"===$.type(a)?b=(1===a.nodeType?a:null!=(c="function"==typeof a.get?a.get(0):void 0)?c:{})["H5F-form"]:"string"===$.type(a)&&(b=a),b},e=function(){function a(a){var b;b=this,this.form=a,this.novalidate=a.hasAttribute("novalidate"),this.invalidCount=0,$("[name]:not(select, [type='hidden'], "+v+")",$(a)).each(function(){var a,c;return a=$(this),c=a.prop("name"),b.addField(new d(this))})}return a.prototype.addField=function(a){var b;return null==this.fields&&(this.fields={}),null==this.sequence&&(this.sequence=[]),b=a.name,null==this.fields[b]&&(a.validated=!1,this.fields[b]=a,this.sequence.push(b)),a},a.prototype.addValidation=function(a,b){var c;return null!=(c=this.fields[a])?c.addValidation(b):void 0},a.version=f.version,a.forms={length:0},a.init=function(a,b){var c;return c=this,$(a).each(function(){var a,d,e,f,g;return d=$(this),a="H5F-form",g=$.extend({},k,b,{immediate:function(){var a;return a=d.attr("data-h5f-immediate"),a="true"===a?!0:"false"===a?!1:void 0}()}),null==this[a]&&(f=new c(this),e=n(f),c.forms[e]=f,c.forms.length++,this[a]=e,d.attr("novalidate",!0),null==d.attr("data-h5f-novalidate"))?j(d,f,g.immediate===!0):void 0})},a.destroy=function(a){var b,d,e;if(d=p(a),e=this.forms[d],null!=e){a=$(e.form),a.off(".H5F"),$("[name]",a).off(".H5F"),$(".H5F-label--required",a).removeClass("H5F-label--required"),e.novalidate?a.attr("novalidate",!0):a.removeAttr("novalidate");try{delete this.forms[d]}catch(f){b=f,this.forms[d]=null}return this.forms.length--,a.trigger(c.DESTROY),!0}return!1},a.get=function(a){return this.forms[p(a)]},a.errors=function(a){return $.extend(b,a)},a.rules=function(a){return $.extend(h,a)},a}(),a[f.name]=e});
//# sourceMappingURL=html5form.min.map